<style>
.print-format {
	font-size: 10pt !important;
}
.print-format td {
	vertical-align:middle !important;
}
</style>

<h2 class="text-center" style="margin-top:0">Price List</h2>
<h4 class="text-center">
	{% if (filters.customer_name) { %}
		{%= filters.customer_name %}
	{% } else if(filters.customer) { %}
		{%= filters.customer %}
	{% } %}
</h4>
<h5 class="text-center">
	{%= __("From") %}
	{%= frappe.datetime.str_to_user(filters.date) %}
</h5>

{%

var item_groups = {};

for(var i = 0; i < data.length; i++) {
    if (!data[i].item_code) {
        continue;
    }

    if (!item_groups.hasOwnProperty(data[i].item_group)) {
        item_groups[data[i].item_group] = [];
    }

    var group = item_groups[data[i].item_group];
    group.push(data[i]);
}

$.each(item_groups || {}, function(item_group, items) {
    item_groups[item_group] = items.sort((a, b) => a.item_name.localeCompare(b.item_name));
});

var ordered = {};
Object.keys(item_groups).sort().forEach(function(key) {
  ordered[key] = item_groups[key];
});
item_groups = ordered;

%}

<table class="table table-bordered">
	<thead>
		<tr>
            <th>{%= __("Product") %}</th>
            <th>{%= __("Origin") %}</th>
            <th>{%= __("Lbs") %}</th>
            <th>{%= __("Price") %}</th>
		</tr>
	</thead>
	<tbody>
    {% $.each(item_groups || {}, function(item_group, items) { %}
        <tr>
            <td colspan="4"><strong>{%= item_group %}</strong></td>
        </tr>

        {% $.each(items || [], function(i, d) { %}
            <tr>
                <td>{%= d.item_name %}</td>
                <td>{%= d.origin %}</td>
                <td>{%= format_number(d.weight) %}</td>
                <td>{%= d.print_rate ? format_currency(d.print_rate) : '' %}</td>
            </tr>
        {% }); %}
    {% }); %}
	</tbody>
</table>
<p class="text-right text-muted">{{ __("Printed On ") }}{%= frappe.datetime.str_to_user(frappe.datetime.get_datetime_as_string()) %}</p>
